<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="An impressive and flawless site template that includes various UI elements and countless features, attractive ready-made blocks and rich pages, basically everything you need to create a unique and professional website."
    />
    <meta
      name="keywords"
      content="bootstrap 5, business, corporate, creative, gulp, marketing, minimal, modern, multipurpose, one page, responsive, saas, sass, seo, startup, html5 template, site template"
    />
    <meta name="author" content="elemis" />
    <title>Desa Bumi Sriwijaya</title>
    <link rel="shortcut icon" href="./assets/logo/logo.png" />
    <link rel="stylesheet" href="./assets/css/plugins.css" />
    <link rel="stylesheet" href="./assets/css/style.css" />
    <style>
      .preloader {
        align-items: center;
        background: linear-gradient(
          rgba(53, 147, 255, 1),
          rgba(218, 33, 255, 1)
        );
        display: flex;
        height: 100vh;
        justify-content: center;
        left: 0;
        position: fixed;
        top: 0;
        transition: opacity 0.2s linear;
        width: 100%;
        z-index: 9999;
        opacity: 1;
        transform: opacity 1s linear;
      }
    </style>
  </head>

  <body>
    <div class="content-wrapper" id="app">
      <div class="preloader" v-if="preloader">
        <img src="./assets/logo/loader-logo.gif" alt="spinner" class="h-10" />
      </div>

      <header class="wrapper bg-soft-primary">
        <nav
          class="navbar navbar-expand-lg center-logo bg-image position-absolute navbar-dark"
          data-image-src="./assets/img/photos/bg2.jpg"
        >
          <div
            class="container justify-content-between align-items-center mx-1"
            style="max-width: 100%"
          >
            <div
              class="d-flex flex-row w-100 justify-content-between align-items-center d-lg-none"
            >
              <div class="navbar-brand py-2">
                <a href="./index.html">
                  <img
                    class="logo-dark"
                    src="./assets/logo/logofont.png"
                    srcset="./assets/logo/logofont.png 8x"
                    alt=""
                  />
                  <img
                    class="logo-light"
                    src="./assets/logo/logofont.png"
                    srcset="./assets/logo/logofont.png 8x"
                    alt=""
                  />
                </a>
              </div>

              <div class="navbar-other ms-auto">
                <ul class="navbar-nav flex-row align-items-center">
                  <li class="nav-item">
                    <nav
                      class="nav social social-white justify-content-end text-end"
                    >
                      <a
                        href="https://www.facebook.com/people/Bps-Provinsi-Sumatera-Selatan/100015484759318/"
                        target="_blank"
                        ><i class="uil uil-facebook-f"></i
                      ></a>
                      <a
                        href="https://www.instagram.com/bpssumsel/?hl=en"
                        target="_blank"
                        ><i class="uil uil-instagram"></i
                      ></a>
                      <a
                        href="https://www.youtube.com/channel/UC-9WQN-5cNTVTGDF8Rkiu6A"
                        target="_blank"
                        ><i class="uil uil-youtube"></i
                      ></a>
                    </nav>
                  </li>
                  <li class="nav-item d-lg-none">
                    <button class="hamburger offcanvas-nav-btn">
                      <span></span>
                    </button>
                  </li>
                </ul>
              </div>
            </div>

            <div
              class="navbar-collapse-wrapper d-flex flex-row align-items-center w-100"
            >
              <div
                class="navbar-collapse offcanvas offcanvas-nav offcanvas-start"
              >
                <div class="navbar-brand px-2">
                  <a href="./index.html">
                    <img
                      src="./assets/logo/logofont.png"
                      srcset="./assets/logo/logofont.png 8x"
                      alt=""
                    />
                  </a>
                </div>

                <div class="w-100 order-1 order-lg-0 d-lg-flex offcanvas-body">
                  <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                      <a class="nav-link dropdown-toggle" href="./home.html"
                        >Profile</a
                      >
                      <ul class="dropdown-menu">
                        <li class="nav-item">
                          <a class="dropdown-item" href="./monograph.html"
                            >Monograph</a
                          >
                        </li>
                        <li class="nav-item">
                          <a class="dropdown-item" href="#">Organisasi</a>
                        </li>
                      </ul>
                    </li>
                    <li class="nav-item dropdown">
                      <a
                        class="nav-link dropdown-toggle"
                        href="#"
                        data-bs-toggle="dropdown"
                        >Kependudukan</a
                      >
                      <ul class="dropdown-menu">
                        <li class="nav-item">
                          <a class="dropdown-item" href="./kemiskinan.html"
                            >Kemiskinan</a
                          >
                        </li>
                        <li class="nav-item">
                          <a class="dropdown-item" href="./stunting.html"
                            >Stunting</a
                          >
                        </li>
                        <li class="nav-item">
                          <a class="dropdown-item" href="./penduduk.html"
                            >Penduduk</a
                          >
                        </li>
                      </ul>
                    </li>
                    <li class="nav-item dropdown">
                      <a
                        class="nav-link dropdown-toggle"
                        href="#"
                        data-bs-toggle="dropdown"
                        >Ekonomi</a
                      >
                      <ul class="dropdown-menu">
                        <li class="nav-item">
                          <a class="dropdown-item" href="./umkm.html">UMKM</a>
                        </li>
                      </ul>
                    </li>
                    <li class="nav-item">
                      <a class="nav-link" href="#" target="_blank">Tematik</a>
                    </li>
                  </ul>
                </div>
                <div
                  class="w-100 order-3 order-lg-2 d-lg-flex offcanvas-body text-end"
                >
                  <ul class="navbar-nav ms-auto me-0">
                    <li class="text-end d-none d-lg-block navbar-other">
                      <nav class="nav social social-white mt-2">
                        <a
                          href="https://www.facebook.com/people/Bps-Provinsi-Sumatera-Selatan/100015484759318/"
                          target="_blank"
                          ><i class="uil uil-facebook-f"></i
                        ></a>
                        <a
                          href="https://www.instagram.com/bpssumsel/?hl=en"
                          target="_blank"
                          ><i class="uil uil-instagram"></i
                        ></a>
                        <a
                          href="https://www.youtube.com/channel/UC-9WQN-5cNTVTGDF8Rkiu6A"
                          target="_blank"
                          ><i class="uil uil-youtube"></i
                        ></a>
                      </nav>
                    </li>
                  </ul>
                </div>
                <div class="offcanvas-body order-4 mt-auto">
                  <div class="d-lg-none mt-auto pt-6 pb-6 order-4">
                    <a href="mailto:first.last@email.com" class="link-inverse"
                      >info@email.com</a
                    >
                    <br />
                    00 (123) 456 78 90 <br />
                    <nav class="nav social social-white mt-4">
                      <a
                        href="https://www.facebook.com/people/Bps-Provinsi-Sumatera-Selatan/100015484759318/"
                        target="_blank"
                        ><i class="uil uil-facebook-f"></i
                      ></a>
                      <a
                        href="https://www.instagram.com/bpssumsel/?hl=en"
                        target="_blank"
                        ><i class="uil uil-instagram"></i
                      ></a>
                      <a
                        href="https://www.youtube.com/channel/UC-9WQN-5cNTVTGDF8Rkiu6A"
                        target="_blank"
                        ><i class="uil uil-youtube"></i
                      ></a>
                    </nav>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </nav>
      </header>

      <section
        class="wrapper image-wrapper bg-image bg-overlay bg-overlay-900 bg-overlay-900"
        data-image-src="./assets/img/desa/desa_1.jpg"
      >
        <div class="container pt-6 pt-md-15 pb-8">
          <div
            class="row gx-lg-8 gy-8 mt-5 mt-md-12 mt-lg-0 mb-8 align-items-center"
          >
            <div class="col-lg-6 order-lg-2">
              <div
                class="row gx-md-5 gy-5"
                data-cues="fadeIn"
                data-group="images"
              >
                <div class="col-md-6 text-center">
                  <figure class="rounded mx-4">
                    <img
                      src="./assets/prov-logo/prov_logo.png"
                      srcset="./assets/prov-logo/prov_logo.png 2x"
                      alt=""
                      style="
                        max-height: 300px;
                        max-width: 200px;
                        height: 100%;
                        width: 100%;
                      "
                    />
                  </figure>
                </div>
                <div class="col-md-6 text-center">
                  <figure class="rounded mx-4">
                    <img
                      src="./assets/kabs-logo/logo1601.png"
                      srcset="./assets/kabs-logo/logo1601.png 2x"
                      alt=""
                      style="
                        max-height: 300px;
                        max-width: 200px;
                        height: 100%;
                        width: 100%;
                      "
                    />
                  </figure>
                </div>
              </div>
            </div>
            <div class="col-lg-6 text-white">
              <div
                data-cues="slideInDown"
                data-group="page-title"
                data-delay="600"
              >
                <h1 class="display-1 text-white mb-4">
                  {{ wilayah.tingkat }} <br />
                  <span
                    class="typer text-sky"
                    data-delay="100"
                    :data-words="wilayah.nama"
                  >
                  </span>
                  <span class="cursor text-sky" data-owner="typer"></span>
                </h1>
                <p class="lead fs-24 lh-sm text-white mb-7">{{ deskripsi }}</p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="wrapper bg-light" v-if="show">
        <div class="container py-6 py-md-8">
          <div class="row text-center">
            <div class="col-md-10 offset-md-1 col-lg-8 offset-lg-2">
              <h3 class="display-4 mb-10 px-xl-10">Penduduk</h3>
            </div>
          </div>
          <div class="position-relative mb-4 mb-md-6">
            <div
              class="shape rounded-circle bg-soft-primary rellax w-16 h-16"
              data-rellax-speed="1"
              style="top: -0.5rem; right: -2.5rem; z-index: 0"
            ></div>
            <div
              class="shape bg-dot primary rellax w-16 h-17"
              data-rellax-speed="1"
              style="top: -0.5rem; left: -2.5rem; z-index: 0"
            ></div>
            <div class="row gx-md-5 gy-5">
              <div class="col-lg-6 d-flex align-items-stretch">
                <div class="card w-100">
                  <div
                    class="card-body d-flex justify-content-center align-items-center"
                  >
                    <canvas ref="pendidikanTerakhir"></canvas>
                  </div>
                </div>
              </div>
              <div class="col-lg-6 d-flex align-items-stretch">
                <div class="card w-100">
                  <div
                    class="card-body d-flex justify-content-center align-items-center"
                  >
                    <canvas ref="jenisPekerjaan"></canvas>
                  </div>
                </div>
              </div>
              <div class="col-12">
                <div class="card">
                  <div class="card-body">
                    <div class="row">
                      <div class="col-xl-11 col-lg-10 col-md-9 col-sm-8 mb-2">
                        <div class="form-floating">
                          <input
                            id="pencarian"
                            type="text"
                            class="form-control"
                            placeholder="Pencarian"
                            v-model="pencarian"
                            @keyup.enter="getPenduduk()"
                          />
                          <label for="pencarian">Pencarian</label>
                        </div>
                      </div>
                      <div class="col-xl-1 col-lg-2 col-md-3 col-sm-4 mb-2">
                        <a
                          class="btn btn-primary rounded-0"
                          @click="getPenduduk()"
                          >Cari!</a
                        >
                      </div>
                      <div class="col-12 mb-2">
                        <div class="table-responsive" ref="tabelPenduduk">
                          <table class="table table-striped">
                            <thead>
                              <tr>
                                <th>NIK</th>
                                <th>No KK</th>
                                <th>Nama Lengkap</th>
                                <th>Jenis Kelamin</th>
                                <th>Tempat Lahir</th>
                                <th>Tanggal Lahir</th>
                                <th>Umur</th>
                                <th>Pendidikan Terakhir</th>
                                <th>Status Pekerjaan</th>
                                <th>Pekerjaan</th>
                                <th>Jenis Pekerjaan</th>
                                <th>Nama SLS</th>
                                <th>Alamat</th>
                                <th>Status Stunting</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr v-for="p in penduduk.data">
                                <td>{{ p.nik }}</td>
                                <td>{{ p.no_kk }}</td>
                                <td>{{ p.nama_lengkap }}</td>
                                <td>
                                  {{ nameKategori(p.jenis_kelamin,
                                  "jenis_kelamin") }}
                                </td>
                                <td>{{ p.tempat_lahir }}</td>
                                <td>{{ p.tanggal_lahir }}</td>
                                <td>{{ p.umur }}</td>
                                <td>
                                  {{ nameKategori(p.pendidikan_terakhir,
                                  "pendidikan") }}
                                </td>
                                <td>
                                  {{ p.status_pekerjaan == 1 ? "Bekerja" :
                                  "Tidak Bekerja" }}
                                </td>
                                <td>{{ p.pekerjaan }}</td>
                                <td>
                                  {{ nameKategori(p.jenis_pekerjaan,
                                  "lap_usaha") }}
                                </td>
                                <td>{{ p.nama_sls }}</td>
                                <td>{{ p.alamat }}</td>
                                <td>
                                  {{ nameKategori(p.status_stunting, "stunting")
                                  }}
                                </td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </div>
                      <div class="col-12 d-flex justify-content-center">
                        <div class="table-responsive">
                          <nav aria-label="pagination penduduk">
                            <ul class="pagination">
                              <li
                                class="page-item"
                                :class="{ disabled: l.active || !l.url }"
                                v-for="l in penduduk.links"
                              >
                                <a class="page-link" @click="getPenduduk(l.url)"
                                  ><span
                                    v-html="l.label.replace('Previous', '').replace('Next', '')"
                                  ></span
                                ></a>
                              </li>
                            </ul>
                          </nav>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      <section class="wrapper bg-light" v-else>
        <div class="container py-6 py-md-8">
          <h3>Belum Ada Data</h3>
        </div>
      </section>

      <footer
        class="bg-dark text-inverse"
        data-image-src="./assets/img/photos/bg2.jpg"
      >
        <div
          class="container mx-10 pb-7 pb-md-7 pt-3 mt-3"
          style="max-width: 92%"
        >
          <div class="row gy-6 gy-lg-0">
            <div class="col-md-4 col-lg-4">
              <div class="widget">
                <img
                  class="mb-4"
                  src="./assets/logo/logo.png"
                  srcset="./assets/logo/logo.png 8x"
                  alt=""
                />
                <p class="mb-4">
                  © 2023 Developer 1600<br class="d-none d-lg-block" />Hak Cipta
                </p>
                <nav class="nav social social-white">
                  <a
                    href="https://www.facebook.com/people/Bps-Provinsi-Sumatera-Selatan/100015484759318/"
                    target="_blank"
                    ><i class="uil uil-facebook-f"></i
                  ></a>
                  <a
                    href="https://www.instagram.com/bpssumsel/?hl=en"
                    target="_blank"
                    ><i class="uil uil-instagram"></i
                  ></a>
                  <a
                    href="https://www.youtube.com/channel/UC-9WQN-5cNTVTGDF8Rkiu6A"
                    target="_blank"
                    ><i class="uil uil-youtube"></i
                  ></a>
                </nav>
              </div>
            </div>

            <div class="col-md-4 col-lg-4">
              <div class="widget">
                <h4 class="widget-title text-white mb-3">Hubungi Kami</h4>
                <address class="pe-xl-15 pe-xxl-17">
                  Jl. Kapten Anwar Sastro No 1694 Palembang, Sumatera Selatan
                  30129
                </address>
                <a href="mailto:#">bps1600@bps.go.id</a><br />
                Telp (0711) 351665, 318456
              </div>
            </div>

            <div class="col-md-4 col-lg-4">
              <div class="widget">
                <h4 class="widget-title text-white mb-3">Selengkapnya</h4>
                <ul class="list-unstyled mb-0">
                  <li>
                    <a href="https://sumsel.bps.go.id" target="_blank"
                      >Official BPS SUMSEL</a
                    >
                  </li>
                  <li>
                    <a href="https://pstdigital.bpssumsel.com" target="_blank"
                      >Konsultasi Online</a
                    >
                  </li>
                  <li>
                    <a
                      href="https://sdgsforsumsel.bpssumsel.com"
                      target="_blank"
                      >SDG's For Sumsel</a
                    >
                  </li>
                  <li>
                    <a href="https://zi.bpssumsel.com" target="_blank"
                      >Zona Integritas</a
                    >
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </footer>

      <div class="progress-wrap">
        <svg
          class="progress-circle svg-content"
          width="100%"
          height="100%"
          viewBox="-1 -1 102 102"
        >
          <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98" />
        </svg>
      </div>
    </div>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://unpkg.com/chart.js/dist/chart.umd.js"></script>
    <script>
      const { createApp } = Vue;

      createApp({
        data() {
          return {
            url: "https://descan.bpssumsel.com/api/",
            kode: "1606021007",
            wilayah: {},
            deskripsi: "",
            kategori: [],
            penduduk: {},
            pendidikanTerakhir: { sd: 100, smp: 50, sma: 20 },
            pendidikanTerakhirLabel: { 3: "SD", 8: "SMP", 13: "SMA" },
            pendidikanTerakhirSelected: "",
            jenisPekerjaan: {
              pertanian_tanaman_padi_dan_palawija: 1000,
              hortikultura: 250,
              perkebunan: 50,
            },
            jenisPekerjaanLabel: {
              1: "Pertanian tanaman padi & palawija",
              2: "Hortikultura",
              3: "Perkebunan",
            },
            jenisPekerjaanSelected: "",
            pencarian: "",
            show: false,
            preloader: true,
          };
        },
        methods: {
          async getWilayah() {
            await axios
              .get(this.url + "wilayah/" + this.kode + "/show")
              .then((d) => {
                this.wilayah = d.data.datas.result;

                const kode =
                  "16" +
                  this.wilayah.kode_kab.replace("00", "") +
                  this.wilayah.kode_kec.replace("000", "") +
                  this.wilayah.kode_desa.replace("000", "");

                switch (kode.length) {
                  case 2:
                    this.wilayah.tingkat = "Provinsi";
                    break;
                  case 4:
                    this.wilayah.tingkat = "Kabupaten/Kota";
                    break;
                  case 7:
                    this.wilayah.tingkat = "Kecamatan";
                    break;
                  case 10:
                    this.wilayah.tingkat = "Desa/Kelurahan";
                    break;
                }
              });
          },
          async getDeskripsi() {
            await axios
              .get(this.url + "wilayah/" + this.kode + "/deskripsi")
              .then((d) => {
                this.deskripsi = d.data.datas.deskripsi;
              });
          },
          createChart() {
            const chartPendidikanTerakhir = new Chart(
              this.$refs["pendidikanTerakhir"],
              {
                type: "bar",
                data: {
                  labels: Object.values(this.pendidikanTerakhirLabel),
                  datasets: [
                    {
                      label: "Pendidikan Terakhir",
                      data: Object.values(this.pendidikanTerakhir),
                    },
                  ],
                },
                options: {
                  indexAxis: "y",
                  onClick: (e) => {
                    const points =
                      chartPendidikanTerakhir.getElementsAtEventForMode(
                        e,
                        "point",
                        { intersect: true },
                        true
                      );

                    if (points.length) {
                      for (p in this.pendidikanTerakhirLabel)
                        if (
                          this.pendidikanTerakhirLabel[p] ==
                          chartPendidikanTerakhir.data.labels[points[0].index]
                        )
                          this.pendidikanTerakhirSelected = p;

                      this.getPenduduk();

                      this.$refs["tabelPenduduk"].scrollIntoView({
                        behavior: "smooth",
                        block: "start",
                        inline: "start",
                      });
                    }
                  },
                  plugins: {
                    title: {
                      display: true,
                      text: "Jumlah Penduduk Berdasarkan Pendidikan Terakhir",
                      font: {
                        size: 18,
                      },
                    },
                  },
                },
              }
            );

            const chartJenisPekerjaan = new Chart(
              this.$refs["jenisPekerjaan"],
              {
                type: "bar",
                data: {
                  labels: Object.values(this.jenisPekerjaanLabel),
                  datasets: [
                    {
                      label: "Jenis Pekerjaan",
                      data: Object.values(this.jenisPekerjaan),
                    },
                  ],
                },
                options: {
                  indexAxis: "y",
                  onClick: (e) => {
                    const points =
                      chartJenisPekerjaan.getElementsAtEventForMode(
                        e,
                        "point",
                        { intersect: true },
                        true
                      );

                    if (points.length) {
                      for (p in this.jenisPekerjaanLabel)
                        if (
                          this.jenisPekerjaanLabel[p] ==
                          chartJenisPekerjaan.data.labels[points[0].index]
                        )
                          this.jenisPekerjaanSelected = p;

                      this.getPenduduk();

                      this.$refs["tabelPenduduk"].scrollIntoView({
                        behavior: "smooth",
                        block: "start",
                        inline: "start",
                      });
                    }
                  },
                  plugins: {
                    title: {
                      display: true,
                      text: "Jumlah Penduduk Berdasarkan Jenis Pekerjaan",
                      font: {
                        size: 18,
                      },
                    },
                  },
                },
              }
            );
          },
          async getKategori() {
            let total = await axios.get(this.url + "kategori");

            total = total.data.datas.total;

            await axios
              .get(this.url + "kategori?per_page=" + total)
              .then((d) => {
                this.kategori = d.data.datas.data;
              });
          },
          nameKategori(kode, tag) {
            let kategoriByTag = this.kategori.filter((k) => k.tag == tag);
            let kategoriGetKode = kategoriByTag.find((k) => k.kode == kode);
            if (kategoriGetKode) return kategoriGetKode.name;
            else return "";
          },
          async getPenduduk(suffix) {
            var url = "";

            if (suffix) url = this.url + suffix;
            else
              url =
                this.url +
                "penduduk/" +
                this.kode +
                "/list?pendidikan_terakhir=" +
                this.pendidikanTerakhirSelected +
                "&jenis_pekerjaan=" +
                this.jenisPekerjaanSelected +
                "&keyword=" +
                this.pencarian;

            await axios.get(url).then((d) => {
              this.penduduk = d.data.datas;

              if (this.penduduk.data.length != 0) this.show = true;
            });
          },
          loadJS() {
            const pluginsjs = document.createElement("script");
            pluginsjs.setAttribute("src", "./assets/js/plugins.js");
            document.head.appendChild(pluginsjs);

            const themejs = document.createElement("script");
            themejs.setAttribute("src", "./assets/js/theme.js");
            document.head.appendChild(themejs);

            setTimeout(() => theme.init(), 100);
          },
        },
        mounted() {
          this.getWilayah()
            .then(() => this.getDeskripsi())
            .then(() => setTimeout(() => this.loadJS(), 100))
            .then(() => (this.preloader = false));
          this.getKategori().then(() =>
            setTimeout(() => this.createChart(), 100)
          );
          this.getPenduduk();
        },
        watch: {
          statusStuntingSelected() {
            this.getPenduduk();

            this.$refs["tabelStunting"].scrollIntoView({
              behavior: "smooth",
              block: "start",
              inline: "start",
            });
          },
        },
      }).mount("#app");
    </script>
  </body>
</html>
